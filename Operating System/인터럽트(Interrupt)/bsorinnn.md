# 인터럽트(Interrupt)

주변 장치와 입출력 장치는 CPU나 메모리와 달리 `인터럽트`라는 매커니즘을 통해 관리됨

### 인터럽트의 수행 이유

입출력 연산이 CPU 명령 수행속도보다 현저히 느리기 때문.
운영체제는 연산 결과가 나올 동안 CPU에게 다른 작업을 시키고, 연산 결과가 나오면 그때 CPU에게 작업 완료를 알리도록 한다.
입출력이 CPU에게 작업 완료를 알리는 것을 `인터럽트`라고 한다.

## 인터럽트

CPU가 프로그램을 실행하고 있을 시, 입출력 하드웨어 등의 장치나 예외 사항이 발생한 경우 마이크로프로세서에게 알려 처리할 수 있도록 하는 것

- 하드웨어 인터럽트
- 소프트웨어 인터럽트

#### 하드웨어 인터럽트

하드웨어가 발생시키는 인터럽트로, CPU가 아닌 다른 하드웨어 장치가 CPU에게 무엇을 알려주거나 CPU 서비스 요청 시 발생

### 소프트웨어 인터럽트

스프트웨어가 발생시키는 인터럽트. 소프트웨어가 스스로 인터럽트 라인 세팅.

<br>

인터럽트를 발생시키기 위해 하드웨어/소프트웨어는 CPU 내에 있는 `인터럽트 라인`을 세팅하여 인터럽트 발생시킴.<br>
CPU는 매번 명령 수행 전 `인터럽트 라인`이 세팅되어 있는지 검사

<br/>

### 인터럽트 과정

1. 현재 수행 중이던 process A는 `system call`을 통해 인터럽트 발생시킴
2. CPU는 현재 진행 중이던 기계어 코드 완료
3. 현재까지 수행 중이던 상태를 해당 process의 **PCB(Process Control Block)** 에 저장
4. PC(Program Counter)에 다음에 실행할 명령 주소 저장
5. 인터럽트 벡터를 읽고 ISR 주소값을 얻어 **ISR(Interrupt Service Routine)** 으로 점프하여 루틴 실행
6. 해당 코드 실행
7. 해당 일을 모두 처리하면 대피시킨 레지스트리 복원
8. ISR의 끝에 있는 IRET 명령어로 인터럽트 해제
9. IRET 명령어 실행되면 대피시킨 PC값 복원하여 사용

> CPU가 인터럽트로 건너갈 수 있는 것, 인터럽트 종료 후 원래 명령어를 실행할 수 있는 것 모두 **컨텍스트 스위칭** 이 가능하기 때문

### 인터럽트와 명령

CPU 수행 명령에는 `일반 명령`과 `특권 명령`이 있다.

- 일반 명령: 모든 프로그램이 수행 가능한 명령

  ex) 메모리에서 자료 읽어오기, CPU에서 계산하기

- 특권 명령: 보안이 필요한 명령. 항상 `운영체제`만 수행 기능

  ex) 입출력 장치, 타이머 등 장치 접근

## 참고자료

🔗 https://velog.io/@adam2/%EC%9D%B8%ED%84%B0%EB%9F%BD%ED%8A%B8
