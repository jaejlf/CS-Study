# 1. **Deadlock**

> 일련의 프로세스들이 서로가 가진 자원을 기다리며 block 되어 더 이상 진행될 수 없는 상태<br/>
데드락은 모든 프로세스가 Request 상태가 되어있는 상황임
> 

프로세스가 자원을 요청하는 절차

- Request : 자원을 요청하고 다른 프로세스가 자원을 사용하고 있어 받을 수 없다면 대기함
- Allocate : 자원을 할당받음
- Use : 프로세스가 받은 자원을 사용함
- Release : 프로세스가 자원을 놓아줌

<br/><br/>

# 2. **Deadlock** 발생 조건

네 가지 조건 모두 만족해야 데드락이 발생함

1. 상호 배제, Mutual exclusion : 매 순간 하나의 프로세스만이 자원을 사용할 수 있음.
2. 보유 대기, Hold and wait : 자원을 가진 프로세스가 다른 자원을 기다릴 때 보유하고 있는 자원을 놓지 않고 계속 가지고 있는 상황
3. 비선점, No preemption : 프로세스가 선점 방식(OS에 의해 강제로 자원을 뺏기는 방식)을 사용하지 않는 상황
4. 순환 대기, Circular wait : 자원을 기다리는 프로세스 간에 사이클이 형성되어야 함. 

<br/><br/>

# 3. **Deadlock Prevention**

**교착 상태 예방, Deadlock Prevention**

→ 교착 상태가 발생하기 전에 deadlock의 4가지 필요 조건 중 하나가 만족되지 않도록 하는 방식. (예방 개념) 그러나 이 방식은 효율성과 처리량을 감소시키고 기아 문제가 발생할 수 있음. 

1. Mutual exclusion prevention : 모든 자원들을 공유 허가해야 함. 
2. Hold and wait prevention : 프로세스가 자원을 요청할 때 다른 어떤 자원도 가지고 있지 않도록 해야함. 즉 프로세스를 시작할 때 모든 필요한 자원을 할당 받고 시작하거나 자원이 필요한 경우 가지고 있던 모든 자원을 내놓고 다시 요청하는 방식을 사용해야 함. 
3. No preemption prevention : 필요한 자원을 모두 할당해야 함. 
4. Circular wait prevention : 자원의 타입에 따라 프로세스마다 할당 순서를 정하여 정해진 순서대로만 자원을 할당. 

<br/><br/>

# 4. Deadlock Avoidance

**교착 상태 회피, Deadlock Avoidance**

→ 데드락이 발생할 가능성이 있는 경우에 아예 자원을 할당하지 않는 방식

> Safe Sequence : 프로세스들의 Sequence <P1, P2, … Pn> 가 있을 때 특정 프로세스 Pi의 자원 요청이 `가용 자원 + 모든 Pj(j < i)의 보유 자원`에 의해 충족되는 경우 sequence를 safe하다고 함. <br/> 
Safe state : 시스템 내의 프로세스들에 대한 Safe Sequence가 존재하는 상태.
> 

**Banker’s Algorithm**

각 지원 타입마다 여러 인스턴스가 존재하는 경우 뱅커 알고리즘을 사용함. 

프로세스가 자원을 요청할 때마다 수행됨. 

두 가지 가정을 세워놓고 시작함.

- 모든 프로세스는 자원의 최대 사용량을 미리 명시함.
- 프로세스가 요청 자원을 모두 할당받은 경우 유한 시간 안에 자원들을 다시 반납함

자원을 요청할 때 safe 상태를 유지할 때만 자원을 할당함. → 총 요청 자원의 수가 남은 자원의 수보다 적은 프로세스만 선택하여 수행함. 만약 그런 프로세스가 없다면 unsafe 상태인 것. 할당 받은 프로세스가 종료되면 모든 자원을 반납하고 모든 프로세스가 종료될 때까지 이 과정을 반복함. 

<br/><br/>

# 5. Deadlock Detection & Recovery

우선 데드락 감지를 함. 데드락 감지를 하는 방법은 그래프를 통해 사이클이 생겼는지 확인하거나 총 요청 자원의 수가 남은 자원의 수보다 적은 프로세스가 존재하지 않는다는 것 등이 있음. 

데드락이 발생한 경우 어떤 프로세스를 종료시켜야 되는지에 대한 판단 기준은 아래와 같음.

- 프로세스의 중요도
- 프로세스가 얼마나 오래 실행됐는지
- 얼마나 많은 자원을 사용했는지
- 프로세스가 작업을 마치기 위해 얼마나 많은 자원이 필요한지
- 프로세스가 종료되기 위해 얼마나 많은 자원이 필요한지

위와 같은 기준으로 프로세스를 종료하는 방법도 있고 자원을 선점하는 방식도 있음. 자원을 선점할 때는 어떤 프로세스를 종료시킬지 결정하고(victim 선정) 데드락이 발생하기 전 상태로 Rollback하여 프로세스를 재시작함. 동일한 프로세스가 계속 victim으로 선정되는 경우 기아 현상이 발생함.

<br/><br/>

# 6. Deadlock Ignorance

데드락이 일어나지 않는다고 생각하고 아무런 조취도 취하지 않는 방식임. 왜냐하면 데드락이 매우 드물게 발생하여 데드락에 대한 조치를 취하는 것 자체가 더 큰 오버헤드로 여겨지기 때문.
