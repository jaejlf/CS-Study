# 📍 로드 밸런싱 (Load Balancing)

![image](https://user-images.githubusercontent.com/78673570/190899648-ddc94ca2-589c-42f7-b850-6ab8d39b5feb.png)

- 둘 이상의 CPU or 저장장치와 같은 컴퓨터 자원들에게 작업을 나누는 것
- 분산식 웹 서비스로, 여러 서버에 부하(Load)를 나누어주는 역할
- 서버의 성능보다 많은 트래픽을 감당해야할 때 대응 방안
   - Scale-up : 하드웨어의 성능을 올리기
   - Scale-out : 여러 대의 서버가 나눠서 일하도록 하는 것 <br>   
   => 하드웨어의 향상 비용이 더욱 비싸기도 하고, 서버가 여러 대일 경우 무중단 서비스를 제공하는 환경 구성이 용이하므로 Scale-out이 더 효과적이다.
   
<br>

## 로드 밸런서

- 로드밸런싱 기술을 제공하는 서비스 또는 장치
- 클라이언트와 네트워크 트래픽이 집중되는 서버들 또는 네트워크 허브 사이에 위치

<br>

### L4 Load Balancing

![image](https://user-images.githubusercontent.com/78673570/190899953-ac1e3419-3850-4cf4-9b56-4686575e1bda.png)

- `전송 계층`에서 로드를 분산한다.
- IP주소나 포트번호, MAC 주소 등에 따라 트래픽을 나누고 분산처리가 가능하다.
- CLB(Connection Load Balancer) 혹은 SLB(Session Load Balancer)라고 부르기도 한다.

<br>

### L7 Load Balancing

![image](https://user-images.githubusercontent.com/78673570/190899995-0f8a659f-1ad9-4cb7-a596-8a8829c10063.png)

- `애플리케이션 계층`에서 로드를 분산한다.
- OSI 7계층의 프로토콜(HTTP, SMTP, FTP 등)을 바탕으로도 분산 처리가 가능하다.
- 패킷의 내용을 확인하고 그 내용에 따라 로드를 특정 서버에 분배할 수 있다. (ex. URL에 따라 부하 분산, HTTP 헤더 쿠키 값에 따라 부하 분산 등)

<br>

## 로드 밸런싱 기법

### 라운드 로빈 방식(Round Robin Method)

- 서버에 들어온 요청을 순서대로 돌아가며 배정하는 방식
- 클라이언트의 요청을 순서대로 분배하기 때문에 여러 대의 서버가 동일한 스펙을 갖고 있고, 서버와의 연결(세션)이 오래 지속되지 않는 경우에 활용하기 적합

<br>

### 가중 라운드 로빈 방식(Weighted Round Robin Method)

- 각각의 서버마다 가중치를 매기고 가중치가 높은 서버에 클라이언트 요청을 우선적으로 배분하는 방식
- 주로 서버의 트래픽 처리 능력이 상이한 경우 사용되는 부하 분산 방식
- 예를 들어 A라는 서버가 5라는 가중치를 갖고 B라는 서버가 2라는 가중치를 갖는다면, 로드 밸런서는 라운드로빈 방식으로 A 서버에 5개 B 서버에 2개의 요청을 전달

<br>

### IP 해시 방식(IP Hash Method)

- 클라이언트의 IP 주소를 특정 서버로 매핑하여 요청을 처리하는 방식
- 사용자의 IP를 해싱해(Hashing, 임의의 길이를 지닌 데이터를 고정된 길이의 데이터로 매핑하는 것, 또는 그러한 함수) 로드를 분배하기 때문에 사용자가 항상 동일한 서버로 연결되는 것을 보장

<br>

### 최소 연결 방식(Least Connection Method)

- 요청이 들어온 시점에 가장 적은 연결상태를 보이는 서버에 우선적으로 트래픽을 배분하는 방식
- 자주 세션이 길어지거나, 서버에 분배된 트래픽들이 일정하지 않은 경우에 적합
 
<br>

### 최소 응답 시간 방식(Least Response Time Method)

- 서버의 현재 연결 상태와 응답시간(Response Time, 서버에 요청을 보내고 최초 응답을 받을 때까지 소요되는 시간)을 모두 고려하여 트래픽을 배분하는 방식
- 가장 적은 연결 상태와 가장 짧은 응답시간을 보이는 서버에 우선적으로 로드를 배분
