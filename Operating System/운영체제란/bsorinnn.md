# 운영체제란

- 하드웨어와 사용자(와 각종 소프트웨어) 사이를 연결하는 소프트웨어 계층
- 사용자에게 편리한 인터페이스 환경을 효율적으로 관리하는 시스템

<br>

운영체제 역시 소프트웨어기 때문에 컴퓨터 전원이 켜지면 메모리에 운영체제를 올리는 작업을 한다. 운영체제의 크기는 매우 크기 때문에 핵심적인 부분만 먼저 올리고 나머지 소프트웨어는 필요할 때 메모리에 올려 사용한다. 전원이 들어오고부터 메모리에 항상 올려져 있는 운영체제를 `커널` 이라고 한다.
<br>

## 운영체제의 역할

1. 시스템 자원(System Resource) 관리

- 시스템 자원(System Resource) = 컴퓨터 하드웨어

  - CPU(중앙처리장치), Memory(DRAM, RAM)
  - I/O Devices(입출력 장치)
    - Monitor, Mouse, Keyboard, Network
  - 저장매체: SSD, HDD

  1. CPU: 각 프로그램이 CPU를 얼마나 사용할 것인지?
  2. Memory: 각 프로그램이 어느 주소에 저장되고 어느 정도의 메모리 공간을 확보해줘야 하는지?
  3. 입출력 정치: 스스로 표시 불가능
  4. Network: 인터넷 연결 또는 응용 프로그램이 네트워크 사용 위해서는 운영체제에서 네트워크 프로토콜 지원해야 한다
  5. 저장매체: 어떻게, 어디에 저장할지?

2. 자원 보호

- 사용자가 직접 자원에 접근하는 것 막음으로써 자원 보호 및 관리. 운영체제는 사용자와 응용 프로그램에게 모든 자원 숨긴다

3. 사용자 인터페이스 제공

- 사용자는 운영체제가 숨긴 자원을 인터페이스를 통해 요청할 수 있다.
- 인터페이스는 사용자 인터페이스와 하드웨어 인터페이스가 있다.

### 응용 프로그램이란?

- 프로그램 = 소프트웨어
- 소프트웨어 = 운영체제, 응용 프로그램
- 응용 프로그램 = Application(일반 PC에서 프로그램)

### 운영체제와 응용 프로그램 간의 관계

- 운영체제는 응용 프로그램을 **관리**
  - 응용 프로그램 실행
  - 응용 프로그램간의 **권한** 관리
    - 관리자 권한으로 실행
    - 응용프로그램을 사용하는 **사용자**도 관리
      - 로그인

(결론)

1. 응용 프로그램을 관리
2. 시스템 자원(System Resource)를 관리
3. 사용자와 컴퓨터간의 커뮤니케이션을 지원

> 운영체제의 목표: 사용자가 사용하는 응용 프로그램이 효율적으로, 적절하게 동작하도록 지원

> 운영체제는 응용 프로그램이 요청하는 시스템 리소스를 효율적으로 분배하고, 지원하는 소프트웨어

<br>

## 운영체제 구조

운영체제는 사용자와 응용 프로그램에 인접하여 **커널에 명령을 전달하고 실행 결과를 사용자와 응용 프로그램에게 전달**하는 `인터페이스`와 **운영체제의 핵심 기능**을 모아놓은 `커널`로 구성된다.

<br>
운영체제는 커널과 인터페이스를 분리하여 같은 커널을 사용하더라도 다른 인터페이스를 사용할 수 있다. ex) 유닉스와 OS X

<br>

### 커널

커널은 프로세스 관리, 메모리 관리, 저장장치 관리와 같은 운영체제의 핵심기능을 모아놓은 것으로, 자동차에 비유하면 엔진 같은 것이다.

커널 내부에는 시스템 호출과 드라이버가 있다.

#### 시스템 호출

<img src="https://camo.githubusercontent.com/5df294869a49102571d36d7a023cc9aafa1c219e950b97b8e32ef24c6f8cbd11/68747470733a2f2f6d656469612e766c70742e75732f696d616765732f6c65656a68333232342f706f73742f61313764633463302d333461302d346134622d393338322d6339316138383764393531382f746f7074616c2d626c6f672d696d6167652d313533343434393338373436352d33333665323539336534656164313264363038316434623832323632646263392e77656270">

- 커널이 자신을 보호하기 위해 만든 인터페이스다.
- 커널이 제공하는 시스템 자원 관련 서비스를 모아놓은 것이며 함수 형태로 제공된다.

응용프로그램이나 사용자가 운영체제를 통해 자원을 이용하기 위해서는 이 시스템 호출이라는 인터페이스를 통해 접근해야 한다.

(사용자 영역에서 실행되는) 프로그램이 I/O 작업을 수행하려면 운영체제의 커널에 허락을 구해야 한다. 여기서 시스템 호출이란 바로 프로그램이 그러한 허락을 구하기 위한 수단이다. 운영체제에 따라 디테일한 구현은 다를 수 있겠지만 기본적인 컨셉은 동일.

<br>

+) CPU의 권한 모드

- CPU의 권한 모드
  - 사용자 모드(User mode)
    - 응용 프로그램이 사용(CPU Protection ring Level 3)
  - 커널 모드(kernel mode): 특권 명령어 실행과 원하는 작업 수행을 위한 자원 접근을 가능케 하는 모드
    - OS가 사용 (CPU Protection ring Level 0 : 커널이 사용 , 1~2 : OS가 사용)
- 커널모드에서 실행 가능한 기능들이 있다.
- 커널 모드로 실행하려면, 반드시 API 내의 시스템 콜을 거쳐야 한다(응용 프로그램이 그 기능 사용 위해서는 시스템 콜을 사용하여 **커널 모드로 실행**해야 함)
- 시스템 콜은 운영체제가 제공한다.

(정리)

- 운영체제는 시스템 콜 을 제공
- 프로그래밍 언어별로 운영체제 기능을 활용하기 위해, 시스템 콜을 기반으로 API 제공
- 응용 프로그램은 운영체제 기능 필요시, 해당 API 를 사용해서 프로그램을 작성
- 응용 프로그램이 실행되서, 해당 운영체제 기능이 필요한 API 를 호출하면 시스템 콜이 호출되서 커널모드로 변경되어 OS 내부에서 해당 명령이 실행되고, 다시 응용 프로그램으로 돌아간다.

<br>

#### 드라이버

응용 프로그램 - 커널 과의 인터페이스가 `시스템 콜`이라면

응용 프로그램 - 하드웨어 의 인터페이스는 `드라이버` 이다.

커널은 입출력의 기본적인 부분만 제작하고, 하드웨어의 특성을 반영한 소프트웨어(디바이스 드라이버)를 하드웨어 제작자에게 받아 커널이 실행될 때 함께 실행되도록 한다. 간단한 드라이버는 커널에 포함되어 있고(마우스, 키보드) 복잡한건 따로 설치해야 한다.(프린터)

<br>

### 커널의 역할

- 프로세스 관리: 프로세스에 CPU를 배분하고 작업에 필요한 제반 환경을 제공
- 메모리 관리: 프로세스에 작업 공간을 배치하고 실제 메모리보다 큰 가상공간 제공
- 파일 시스템 관리: 데이터를 저장하고 접근할 수 있는 인터페이스 제공
- 입출력 관리: 필요한 입력과 출력 서비스 제공
- 프로세스 간 통신 관리: 공동 작업을 위한 각 프로세스간 통신 환경 지원

## 참고자료

🔗 https://github.com/kaosanct/Operating-System
🔗 https://github.com/plm9606/interview_store/blob/master/os/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C.md#%EC%BB%A4%EB%84%90
