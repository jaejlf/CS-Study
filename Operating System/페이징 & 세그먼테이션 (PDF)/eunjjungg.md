# 1. Semaphore, Mutex

> Semaphore, Mutex 등장 배경<br/>
: 프로세스 간 메시지를 전송하거나 Critiacal Section에 동시에 접근하는 문제가 발생했을 때 데이터를 한 번에 하나의 프로세스만 접근할 수 있도록 제한을 두는 동기화 방식을 사용해야 함. 이 동기화 도구가 Semaphore, Mutex임. 이 두 도구 모두 공유된 자원의 데이터를 여러 스레드, 프로세스가 접근하는 것을 막는 역할을 함.
> 

<br/><br/>

# 2. Semaphore

공유된 자원의 데이터를 여러 프로세스가 접근하는 것을 막는 것. 세모포어는 리소스의 상태를 나타내는 카운터라고 할 수 있음. 일반적으로 긴 시간을 확보하는 리소스에 대해 이용되며 운영체제의 리소스를 경쟁적으로 사용하는 다중 프로세스에서 행동을 조정하거나 동기화시키는 기술. **하나의 스레드만 들어가게 할 수도 있고 여러 개의 스레드가 들어가게 할 수도 있음**. 

<br/>

**진행 과정**

세마포어는 동기화를 위해 `wait()`, `signal()`을 사용함. `wait()`을 호출하면 세마포어의 카운터를 1 줄이고 세마포어의 카운터가 0보다 작거나 같아질 경우에 락이 실행됨. 세마포어의 카운터가 0보다 작거나 같아져 락이 실행되어 동기화가 실행된 상황에 다른 스레드가 `signal()`을 호출하면 세마포어의 카운터가 1 증가하고 해당 스레드는 락에서 나올 수 있음. 구현 코드([https://github.com/gyoogle/tech-interview-for-developer/blob/master/Computer Science/Operating System/Semaphore %26 Mutex.md](https://github.com/gyoogle/tech-interview-for-developer/blob/master/Computer%20Science/Operating%20System/Semaphore%20%26%20Mutex.md))에서 `P` 연산이 `wait()`이고 `V` 연산이 `signal()`임.

세마포어는 Counting Semaphore, Binary Semaphore 두 가지가 존재하며 카운팅 세마포어는 세마포어 카운트가 양의 정수값을 가지고 설정한 값만큼 스레드를 허용하고 그 이상의 스레드가 자원에 접근하면 락이 실행됨. 바이너리 세마포어는 세마포어의 카운터가 1이며 뮤텍스처럼 사용될 수 있음. 

<br/><br/>

# 3. Mutex

공유된 자원의 데이터를 여러 **스레드**가 접근하는 것을 막는 방법. Critical Section(각 프로세스에서 공유 데이터를 액세스하는 프로그램 코드 부분)을 가진 스레드들의 러닝 타임이 겹치지 않게 각각 단독으로 실행되게 하는 기술. 다중 프로세스들이 공유 리소스에 대한 접근을 조율하기 위해 locking, unlocking을 사용함. 상호 배제를 하여 두 스레드가 동시에 접근할 수 없게 됨. 또한 뮤텍스는 상태가 0, 1로 이진 세마포어라고 부르기도 함. 

- lock : 현재 임계 구역에 들어갈 권한을 얻어옴. 만약 다른 프로세스나 스레드가 임계 구역 수행 중이면 종료할 때까지 대기함.
- unlock : 현재 임계 구역을 모두 사용했음을 알리고 대기중인 다른 프로세스나 스레드가 임계 구역에 진입할 수 있음을 뜻함.

<br/>

**진행 과정**

한 프로세스에 의해 소유될 수 있는 key를 기반으로 한 상호 배제 기법임. key에 해당하는 어떤 객체가 있으며 이 객체를 소유한 프로세스/스레드만이 공유 자원에 접근할 수 있음. 

그리고 뮤텍스는 오직 하나의 쓰레드만이 동일한 시점에 뮤텍스를 얻어 임계 영역에 들어올 수 있고 이 쓰레드만이 임계 영역에서 나갈 때 뮤텍스를 해제할 수 있음. 

```jsx
wait (mutex);
…..
Critical Section
…..
signal (mutex);
```

<br/><br/>

# 4. Semaphore vs Mutex

뮤텍스는 locking 매커니즘으로 락을 걸은 스레드만이 임계 영역을 나갈 때 락을 해제할 수 있지만 세마포어는 Signaling 메커니즘으로 락을 걸지 않은 스레드도 signal을 이용해 락을 해제할 수 있음. 세마포어의 카운터를 1로 설정하면 뮤텍스처럼 활용할 수 있음.
