# 세마포어(Semaphore) & 뮤텍스(Mutex)

## 📌 A. 세마포어(Semaphore)

- 사용하고 있는 스레드/프로세스의 수를 공통으로 관리하는 **하나의 값을 이용해 상호배제 달성**
- 일반적으로 비교적 긴 시간을 확보하는 리소스에 대해 사용
- Lock을 걸지 않은 스레드도 Signal을 보내 Lock을 해제할 수 있음
  - 뮤텍스의 경우 wait 함수를 호출한 스레드(현재 자원을 점유 중인 스레드)만이 Signal 함수 호출 가능

<br/>

ex) 세마포어는 '화장실 칸이 여러 개 있는 식당'!

- 화장실에는 여러 칸이 존재
- 빈 칸 개수를 보여주는 전광판 존재
- 손님이 화장실에 가기 위해서는 입구에서 **빈 칸의 개수를 확인**
  - 빈 칸이 1개 이상이라면 빈 칸의 개수를 하나 줄인 다음 입장
  - 나올 때는 빈 칸의 개수를 하나 증가해줌
  - 모든 칸을 사용 중이면 빈 칸의 개수는 **0**개가 되며, 다른 사용객은 빈 칸의 개수가 **1 또는 양수**로 바뀔 때까지 기다려야 함.

<br/>

👩‍🔧 화장실 이용객 - 프로세스 or 스레드

🚪 화장실 - 공유자원

🖥 화장실 빈 칸의 개수 - 현재 공유자원에 접근할 수 있는 쓰레드,프로세스의 개수

<br/>

=> 세마포어는 공통으로 관리하는 하나의 값을 이용해 상호배제를 달성

<br/>

## 📌 B. 뮤텍스(Mutex)

- 한 프로세스에 의해 소유될 수 있는 **Key를 기반으로 한 상호배제 기법**
- 동기화(Synchronization) 또는 락(Lock)을 사용함으로서 뮤텍스 객체를 두 스레드가 동시에 사용 불가
- 뮤텍스는 상태가 0, 1 뿐이기 때문에 Lock을 가질 수 있고 **이를 소유하고 있는 스레드만이 이 뮤텍스를 해제할 수 있다.**

<br/>

ex) 뮤텍스는 '화장실이 하나 밖에 없는 식당'

- 화장실을 가기 위해서는 카운터에서 열쇠를 받아 가야 함
  - 카운터에 키가 있으면 화장실에 사람이 없다
  - 반대로 카운터에 키가 없으면 다른 사람이 나올 때까지 **대기**
  - 대기 순서대로 들어감

👩‍🔧 화장실 이용객 - 프로세스 or 스레드

🚪 화장실 - 공유자원

🗝 화장실 키 - 공유자원에 접근하기 위한 object

<br/>

=> 뮤텍스는 Key에 해당하는 어떤 오브젝트가 있으며 이 오브젝트를 소유한 (쓰레드,프로세스) 만이 공유자원에 접근할 수 있다!

<br/>

## 📌 C. 세마포어와 뮤텍스의 차이점

| 세마포어(Sempahore)                                         | 뮤텍스(Mutex)                                                                                           |
| ----------------------------------------------------------- | ------------------------------------------------------------------------------------------------------- |
| 동기화 대상이 1개 이상일 떄 사용                            | 동기화 대상이 **오직 1개**일 때 사용                                                                    |
| 자원 소유 **불가**                                          | 자원을 소유할 수 있고, **책임**을 가짐                                                                  |
| 세마포어를 소유하지 않는 스레드가 세마포어를 해제할 수 있음 | 상태가 0, 1 뿐이기에 Lock을 가질 수 있으며 현재 자원을 소유하고 있는 스레드만이 뮤텍스를 해제할 수 있음 |
| 시스템 범위에 걸쳐 있으며, 파일 시스템 상의 파일로 존재     | 시스템 범위에 걸쳐 있으며, 파일 시스템 상의 파일로 존재                                                 |

<br/>

## 📌 D. 참고 자료

🔗[[운영체제]Mutex 뮤텍스와 Sempahore 세마포어의 차이](https://heeonii.tistory.com/14)
